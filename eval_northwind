-- Active: 1665131827383@@127.0.0.1@3306@northwind


--1 - Liste des contacts français :
select CompanyName societe, ContactName contact, ContactTitle fonction, Phone telephone From customers 
WHERE Country = 'France';

--2 - Produits vendus par le fournisseur « Exotic Liquids » :
SELECT ProductName produit,UnitPrice prix from suppliers s
JOIN products p ON p.SupplierID=s.SupplierID
;

--3 - Nombre de produits vendus par les fournisseurs Français dans l’ordre décroissant :
SELECT CompanyName fournisseur,COUNT(*) AS 'nbre produits' FROM suppliers s 
JOIN products p ON p.SupplierID=s.SupplierID
WHERE Country ='France'
GROUP BY fournisseur
ORDER BY COUNT(*) DESC
;

-- 4 - Liste des clients Français ayant plus de 10 commandes :

SELECT CompanyName, COUNT(*) AS nombre_commandes
    FROM customers
    JOIN orders ON customers.CustomerID = orders.CustomerID
    --JOIN `order details` ON orders.OrderID = `order details`.OrderID
    WHERE customers.Country = "France" 
    GROUP BY CompanyName
    HAVING COUNT(*) > 10
    ;

-- 5 - Liste des clients ayant un chiffre d’affaires > 30.000 :

SELECT CompanyName AS "clients", SUM(`order details`.unitPrice * `order details`.Quantity) AS CA, Country as "Country"
    FROM customers
    JOIN orders ON customers.CustomerID = orders.CustomerID
    JOIN `order details` ON orders.OrderID = `order details`.OrderID 
    GROUP BY CompanyName 
    HAVING CA > 30000
    ORDER BY CA DESC
    ;

-- 6 – Liste des pays dont les clients ont passé commande de produits fournis par « Exotic Liquids » :

SELECT Country AS pays ,COUNT(CompanyName) FROM products 
    JOIN suppliers ON products.SupplierID = suppliers.SupplierID
    WHERE CompanyName = 'Exotic Liquids' 
    GROUP BY pays
    ;

    